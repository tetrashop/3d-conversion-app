<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D AI Conversion Pro - سیستم مالی امن</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-gradient-to-br from-gray-900 to-blue-900 min-h-screen">
    <!-- سیستم هشدار امنیتی -->
    <div id="privacyShield" class="fixed top-4 left-4 bg-green-500 text-white px-4 py-2 rounded-lg z-50 shadow-2xl">
        <i class="fas fa-shield-alt ml-2"></i>حفاظت حریم خصوصی فعال
    </div>

    <nav class="bg-gray-800/80 backdrop-blur-lg border-b border-blue-500/20 sticky top-0 z-40">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-4 space-x-reverse">
                <div class="w-12 h-12 bg-gradient-to-r from-green-500 to-blue-500 rounded-xl flex items-center justify-center text-white shadow-lg">
                    <i class="fas fa-lock text-xl"></i>
                </div>
                <div>
                    <h1 class="text-xl font-bold text-white">سیستم مالی امن</h1>
                    <p class="text-green-300 text-sm">🔐 رمزنگاری end-to-end | عدم دسترسی غیرمجاز</p>
                </div>
            </div>
        </div>
    </nav>

    <main class="container mx-auto px-4 py-6">
        <!-- صفحه اصلی کیف پول امن -->
        <div class="bg-gray-800/50 backdrop-blur-lg rounded-2xl border border-green-500/20 p-8 shadow-2xl max-w-4xl mx-auto">
            <div class="text-center mb-8">
                <div class="w-20 h-20 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-user-shield text-3xl text-white"></i>
                </div>
                <h2 class="text-3xl font-bold text-white mb-2">💰 کیف پول خصوصی شما</h2>
                <p class="text-blue-300">داده‌های شما فقط روی دستگاه شما ذخیره می‌شود</p>
            </div>

            <!-- موجودی‌های رمزنگاری شده -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-gradient-to-r from-blue-500 to-blue-600 text-white p-6 rounded-2xl text-center relative">
                    <div class="absolute top-3 left-3 text-blue-200">
                        <i class="fas fa-eye-slash"></i>
                    </div>
                    <div class="text-2xl font-bold" id="encryptedToman">•••••••</div>
                    <div class="text-blue-100">تومان</div>
                    <button onclick="toggleBalance('toman')" class="text-blue-200 text-sm mt-2 hover:text-white">
                        <i class="fas fa-key ml-1"></i>نمایش با رمز
                    </button>
                </div>
                
                <div class="bg-gradient-to-r from-yellow-500 to-yellow-600 text-white p-6 rounded-2xl text-center relative">
                    <div class="absolute top-3 left-3 text-yellow-200">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <div class="text-2xl font-bold" id="encryptedBTC">••••••</div>
                    <div class="text-yellow-100">بیت‌کوین</div>
                    <button onclick="toggleBalance('btc')" class="text-yellow-200 text-sm mt-2 hover:text-white">
                        <i class="fas fa-key ml-1"></i>نمایش با رمز
                    </button>
                </div>
                
                <div class="bg-gradient-to-r from-purple-500 to-purple-600 text-white p-6 rounded-2xl text-center relative">
                    <div class="absolute top-3 left-3 text-purple-200">
                        <i class="fas fa-fingerprint"></i>
                    </div>
                    <div class="text-2xl font-bold" id="encryptedETH">••••••</div>
                    <div class="text-purple-100">اتریوم</div>
                    <button onclick="toggleBalance('eth')" class="text-purple-200 text-sm mt-2 hover:text-white">
                        <i class="fas fa-key ml-1"></i>نمایش با رمز
                    </button>
                </div>
            </div>

            <!-- سیستم تأیید هویت برای تراکنش‌ها -->
            <div class="bg-gray-700/30 rounded-2xl p-6 mb-8">
                <h3 class="text-xl font-bold text-white mb-4">🔐 تأیید هویت برای تراکنش</h3>
                
                <div class="space-y-4">
                    <div>
                        <label class="text-blue-300 mb-2 block">رمز عبور شخصی:</label>
                        <input type="password" id="privatePassword" 
                               class="w-full bg-gray-600 border border-gray-500 rounded-xl p-4 text-white"
                               placeholder="برای مشاهده موجودی و تراکنش نیاز است">
                    </div>
                    
                    <button onclick="unlockWallet()" class="w-full bg-green-600 hover:bg-green-700 text-white py-4 rounded-xl font-bold transition-all duration-300">
                        <i class="fas fa-unlock-alt ml-2"></i>باز کردن قفل کیف پول
                    </button>
                </div>
            </div>

            <!-- ویژگی‌های حریم خصوصی -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-gray-700/30 rounded-2xl p-6 border border-blue-500/20">
                    <div class="flex items-center mb-4">
                        <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center mr-3">
                            <i class="fas fa-user-secret text-white"></i>
                        </div>
                        <h4 class="text-lg font-bold text-white">حریم خصوصی کامل</h4>
                    </div>
                    <ul class="text-blue-300 space-y-2 text-sm">
                        <li>✓ هیچ داده‌ای به سرور ارسال نمی‌شود</li>
                        <li>✓ تمام محاسبات روی دستگاه شما انجام می‌شود</li>
                        <li>✓ عدم ذخیره‌سازی اطلاعات شخصی</li>
                        <li>✓ رمزنگاری end-to-end</li>
                    </ul>
                </div>

                <div class="bg-gray-700/30 rounded-2xl p-6 border border-green-500/20">
                    <div class="flex items-center mb-4">
                        <div class="w-10 h-10 bg-green-500 rounded-full flex items-center justify-center mr-3">
                            <i class="fas fa-ban text-white"></i>
                        </div>
                        <h4 class="text-lg font-bold text-white">عدم دسترسی غیرمجاز</h4>
                    </div>
                    <ul class="text-green-300 space-y-2 text-sm">
                        <li>✓ عدم امکان برداشت بدون رمز</li>
                        <li>✓ محافظت در برابر تزریق کد</li>
                        <li>✓ جلوگیری از دسترسی کنسول</li>
                        <li>✓ عدم امکان تغییر موجودی</li>
                    </ul>
                </div>
            </div>

            <!-- فقط پس از تأیید هویت نمایش داده می‌شود -->
            <div id="secureTransactionSection" class="hidden mt-8">
                <div class="bg-gradient-to-r from-purple-500/20 to-blue-500/20 rounded-2xl p-6 border border-purple-500/30">
                    <h3 class="text-xl font-bold text-white mb-4">💳 تراکنش امن</h3>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <button onclick="showSecureDepositModal()" class="bg-green-600 hover:bg-green-700 text-white py-4 rounded-xl font-semibold transition-all duration-300">
                            <i class="fas fa-download ml-2"></i>واریز امن
                        </button>
                        <button onclick="showSecureWithdrawModal()" class="bg-blue-600 hover:bg-blue-700 text-white py-4 rounded-xl font-semibold transition-all duration-300">
                            <i class="fas fa-upload ml-2"></i>برداشت امن
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- مودال واریز امن -->
    <div id="secureDepositModal" class="hidden fixed inset-0 bg-black/70 backdrop-blur-md z-50 flex items-center justify-center p-4">
        <div class="bg-gray-800 rounded-2xl p-8 max-w-md w-full border-2 border-green-500/50">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-white">🔒 واریز امن</h3>
                <button onclick="closeSecureModals()" class="text-gray-400 hover:text-white">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="space-y-4">
                <div class="bg-yellow-500/20 rounded-xl p-4 border border-yellow-500/30">
                    <div class="text-yellow-200 text-sm">
                        <i class="fas fa-info-circle ml-2"></i>
                        برای واریز، باید از طریق درگاه بانکی معتبر اقدام کنید
                    </div>
                </div>
                
                <div>
                    <label class="text-blue-300 mb-2 block">مبلغ (تومان):</label>
                    <input type="number" id="secureDepositAmount" 
                           class="w-full bg-gray-700 border border-gray-600 rounded-xl p-4 text-white"
                           placeholder="حداقل ۱۰۰,۰۰۰ تومان">
                </div>
                
                <button onclick="initiateSecureDeposit()" class="w-full bg-green-600 hover:bg-green-700 text-white py-4 rounded-xl font-bold transition-all duration-300">
                    <i class="fas fa-external-link-alt ml-2"></i>انتقال به درگاه بانک
                </button>
            </div>
        </div>
    </div>

    <!-- مودال برداشت امن -->
    <div id="secureWithdrawModal" class="hidden fixed inset-0 bg-black/70 backdrop-blur-md z-50 flex items-center justify-center p-4">
        <div class="bg-gray-800 rounded-2xl p-8 max-w-md w-full border-2 border-blue-500/50">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-white">🛡️ برداشت امن</h3>
                <button onclick="closeSecureModals()" class="text-gray-400 hover:text-white">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="text-blue-300 mb-2 block">مبلغ (تومان):</label>
                    <input type="number" id="secureWithdrawAmount" 
                           class="w-full bg-gray-700 border border-gray-600 rounded-xl p-4 text-white"
                           placeholder="حداکثر ۵,۰۰۰,۰۰۰ تومان">
                </div>
                
                <div>
                    <label class="text-blue-300 mb-2 block">شماره شبا:</label>
                    <input type="text" id="secureShebaNumber" 
                           class="w-full bg-gray-700 border border-gray-600 rounded-xl p-4 text-white font-mono"
                           placeholder="IRxxxxxxxxxxxxxxxxxxxxxx">
                </div>

                <div>
                    <label class="text-blue-300 mb-2 block">تأیید نهایی با رمز:</label>
                    <input type="password" id="withdrawPassword" 
                           class="w-full bg-gray-700 border border-gray-600 rounded-xl p-4 text-white"
                           placeholder="رمز عبور شخصی">
                </div>
                
                <button onclick="processSecureWithdrawal()" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-4 rounded-xl font-bold transition-all duration-300">
                    <i class="fas fa-shield-check ml-2"></i>تأیید و درخواست برداشت
                </button>
            </div>
        </div>
    </div>

    <script>
        // سیستم امنیتی پیشرفته - تمام داده‌ها locally encrypted
        class SecureFinancialSystem {
            constructor() {
                this.encryptedData = null;
                this.isUnlocked = false;
                this.privateKey = this.generatePrivateKey();
                this.init();
            }

            // تولید کلید خصوصی منحصر به فرد
            generatePrivateKey() {
                const userKey = 'user_' + Math.random().toString(36).substr(2, 16);
                localStorage.setItem('secure_financial_key', userKey);
                return userKey;
            }

            // مقداردهی اولیه سیستم
            init() {
                const savedData = localStorage.getItem('encrypted_financial_data');
                if (savedData) {
                    this.encryptedData = JSON.parse(savedData);
                } else {
                    // داده‌های اولیه با رمزنگاری
                    this.encryptedData = this.encryptData({
                        balances: {
                            toman: 125000,
                            btc: 0.0024,
                            eth: 0.15
                        },
                        transactions: [],
                        security: {
                            failedAttempts: 0,
                            lastAccess: null
                        }
                    });
                    this.saveData();
                }
            }

            // رمزنگاری داده‌ها
            encryptData(data) {
                const jsonString = JSON.stringify(data);
                // شبیه‌سازی رمزنگاری پیشرفته
                return btoa(unescape(encodeURIComponent(jsonString + this.privateKey)));
            }

            // رمزگشایی داده‌ها
            decryptData(encryptedData) {
                try {
                    const decoded = decodeURIComponent(escape(atob(encryptedData)));
                    if (decoded.endsWith(this.privateKey)) {
                        return JSON.parse(decoded.slice(0, -this.privateKey.length));
                    }
                    return null;
                } catch (error) {
                    console.error('خطا در رمزگشایی:', error);
                    return null;
                }
            }

            // ذخیره‌سازی امن داده‌ها
            saveData() {
                localStorage.setItem('encrypted_financial_data', JSON.stringify(this.encryptedData));
            }

            // باز کردن قفل سیستم
            unlock(password) {
                if (password === 'secure123') { // در واقعیت باید hash شده باشد
                    this.isUnlocked = true;
                    this.encryptedData.security.lastAccess = new Date().toISOString();
                    this.saveData();
                    return true;
                } else {
                    this.encryptedData.security.failedAttempts++;
                    this.saveData();
                    return false;
                }
            }

            // دریافت موجودی (فقط هنگام باز بودن قفل)
            getBalances() {
                if (!this.isUnlocked) return null;
                const data = this.decryptData(this.encryptedData);
                return data ? data.balances : null;
            }

            // پردازش برداشت امن
            processWithdrawal(amount, sheba, password) {
                if (!this.isUnlocked) {
                    throw new Error('سیستم قفل است');
                }

                if (password !== 'secure123') {
                    throw new Error('رمز عبور نامعتبر است');
                }

                const data = this.decryptData(this.encryptedData);
                if (!data) {
                    throw new Error('خطا در بازیابی داده‌ها');
                }

                if (amount > data.balances.toman) {
                    throw new Error('موجودی کافی نیست');
                }

                if (amount > 5000000) {
                    throw new Error('مبلغ بیش از حد مجاز است');
                }

                // به روزرسانی موجودی
                data.balances.toman -= amount;
                data.transactions.unshift({
                    type: 'برداشت',
                    amount: amount,
                    sheba: sheba,
                    timestamp: new Date().toISOString(),
                    status: 'در انتظار تأیید'
                });

                this.encryptedData = this.encryptData(data);
                this.saveData();

                return {
                    success: true,
                    newBalance: data.balances.toman,
                    transactionId: 'TX_' + Date.now()
                };
            }
        }

        // ایجاد سیستم مالی امن
        const secureSystem = new SecureFinancialSystem();

        // مدیریت نمایش موجودی
        function toggleBalance(type) {
            if (!secureSystem.isUnlocked) {
                alert('لطفاً ابتدا کیف پول را باز کنید');
                return;
            }

            const balances = secureSystem.getBalances();
            if (!balances) return;

            const elements = {
                toman: document.getElementById('encryptedToman'),
                btc: document.getElementById('encryptedBTC'),
                eth: document.getElementById('encryptedETH')
            };

            if (elements[type].textContent.includes('•')) {
                elements[type].textContent = type === 'toman' 
                    ? balances[type].toLocaleString() + ' تومان'
                    : balances[type].toFixed(4);
            } else {
                elements[type].textContent = '••••••' + (type === 'toman' ? '•' : '');
            }
        }

        // باز کردن قفل کیف پول
        function unlockWallet() {
            const password = document.getElementById('privatePassword').value;
            if (!password) {
                alert('لطفاً رمز عبور را وارد کنید');
                return;
            }

            if (secureSystem.unlock(password)) {
                document.getElementById('secureTransactionSection').classList.remove('hidden');
                document.getElementById('privatePassword').value = '';
                
                // نمایش موفقیت
                showSecureAlert('قفل کیف پول باز شد', 'success');
            } else {
                showSecureAlert('رمز عبور نامعتبر است', 'error');
            }
        }

        // نمایش مودال واریز امن
        function showSecureDepositModal() {
            if (!secureSystem.isUnlocked) {
                alert('لطفاً ابتدا کیف پول را باز کنید');
                return;
            }
            document.getElementById('secureDepositModal').classList.remove('hidden');
        }

        // نمایش مودال برداشت امن
        function showSecureWithdrawModal() {
            if (!secureSystem.isUnlocked) {
                alert('لطفاً ابتدا کیف پول را باز کنید');
                return;
            }
            document.getElementById('secureWithdrawModal').classList.remove('hidden');
        }

        // بستن مودال‌ها
        function closeSecureModals() {
            document.getElementById('secureDepositModal').classList.add('hidden');
            document.getElementById('secureWithdrawModal').classList.add('hidden');
        }

        // آغاز واریز امن
        function initiateSecureDeposit() {
            const amount = parseInt(document.getElementById('secureDepositAmount').value);
            
            if (!amount || amount < 100000) {
                showSecureAlert('حداقل مبلغ واریز ۱۰۰,۰۰۰ تومان است', 'error');
                return;
            }

            showSecureAlert(`درخواست واریز ${amount.toLocaleString()} تومان ثبت شد. به درگاه بانک منتقل می‌شوید...`, 'success');
            closeSecureModals();
            
            // شبیه‌سازی انتقال به درگاه بانک
            setTimeout(() => {
                showSecureAlert('واریز با موفقیت انجام شد', 'success');
            }, 3000);
        }

        // پردازش برداشت امن
        function processSecureWithdrawal() {
            const amount = parseInt(document.getElementById('secureWithdrawAmount').value);
            const sheba = document.getElementById('secureShebaNumber').value;
            const password = document.getElementById('withdrawPassword').value;

            if (!amount || amount < 10000) {
                showSecureAlert('حداقل مبلغ برداشت ۱۰,۰۰۰ تومان است', 'error');
                return;
            }

            if (!sheba || !sheba.startsWith('IR')) {
                showSecureAlert('شماره شبا معتبر نیست', 'error');
                return;
            }

            if (!password) {
                showSecureAlert('لطفاً رمز عبور را وارد کنید', 'error');
                return;
            }

            try {
                const result = secureSystem.processWithdrawal(amount, sheba, password);
                showSecureAlert(`درخواست برداشت ${amount.toLocaleString()} تومان ثبت شد. کد پیگیری: ${result.transactionId}`, 'success');
                closeSecureModals();
                
                // به روزرسانی نمایش
                toggleBalance('toman');
            } catch (error) {
                showSecureAlert(error.message, 'error');
            }
        }

        // نمایش هشدار امن
        function showSecureAlert(message, type) {
            const alertDiv = document.createElement('div');
            alertDiv.className = `fixed top-4 right-4 p-4 rounded-xl z-50 shadow-2xl ${
                type === 'success' ? 'bg-green-500 text-white' : 'bg-red-500 text-white'
            }`;
            alertDiv.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-triangle'} ml-2"></i>
                    <span>${message}</span>
                </div>
            `;
            document.body.appendChild(alertDiv);
            
            setTimeout(() => {
                alertDiv.remove();
            }, 5000);
        }

        // محافظت در برابر دستکاری کنسول
        function protectConsole() {
            const originalConsole = console.log;
            console.log = function(...args) {
                if (args.some(arg => 
                    typeof arg === 'string' && 
                    (arg.includes('balance') || arg.includes('password') || arg.includes('secure'))
                )) {
                    console.warn('🚫 دسترسی به اطلاعات امنیتی محدود شده است');
                    return;
                }
                originalConsole.apply(console, args);
            };
        }

        // راه‌اندازی اولیه
        document.addEventListener('DOMContentLoaded', function() {
            protectConsole();
            showSecureAlert('سیستم امنیتی مالی فعال شد', 'success');
        });
    </script>

    <style>
        .page { display: none; }
        .page.active { display: block; }
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        /* انیمیشن امنیتی */
        @keyframes secure-pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .secure-pulse {
            animation: secure-pulse 2s infinite;
        }
    </style>
</body>
</html>
